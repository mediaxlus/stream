<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ID MOVIE - Explore Movies</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <style>
        :root {
            --primary: #e50914;
            --bg-dark: #0a0a0a;
            --bg-card: #161616;
            --text-main: #ffffff;
            --text-dim: #a0a0a0;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            padding-top: 135px; 
            padding-bottom: 50px;
        }

        /* HEADER & SEARCH */
        .header-fixed {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            background: var(--bg-dark);
        }

        .navbar {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #222;
        }

        .logo {
            color: var(--primary);
            font-weight: 800;
            font-size: 1.5rem;
            text-decoration: none;
            letter-spacing: 1px;
        }

        .text-white {color: #fff;}

        .search-container {
            position: relative;
            width: 50%;
            max-width: 300px;
        }

        .search-input {
            width: 100%;
            background: #222;
            border: 1px solid #333;
            color: #fff;
            padding: 8px 35px 8px 15px;
            border-radius: 20px;
            outline: none;
            font-size: 0.9rem;
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-dim);
        }

        /* FILTER BAR */
        .filter-bar {
            display: flex;
            gap: 10px;
            padding: 12px 20px;
            overflow-x: auto;
            white-space: nowrap;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #222;
            scrollbar-width: none;
           -webkit-overflow-scrolling: touch;
        }
        .filter-bar::-webkit-scrollbar { display: none; }

        .f-item {
            background: #1a1a1a;
            color: var(--text-dim);
            padding: 7px 18px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            border: 1px solid #333;
            transition: 0.3s;
        }
        .f-item.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* ANIMASI GAMBAR */
        img {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        img.loaded {
            opacity: 1;
        }

        /* PLACEHOLDER LOADING */
        .poster-box {
            background-color: #222;
        }


        /* CONTAINER & GRID */
        .container { max-width: 1200px; margin: 0 auto; padding: 10px 20px; }
        .section-header { margin-bottom: 20px; }
        .section-title {
            font-size: 1.1rem;
            font-weight: 800;
            border-left: 4px solid var(--primary);
            padding-left: 10px;
            text-transform: uppercase;
        }

        .movie-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        @media (min-width: 768px) {
            .movie-grid { grid-template-columns: repeat(4, 1fr); }
        }

        /* MOVIE CARDS */
        .movie-card {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #222;
            transition: 0.3s ease;
            cursor: pointer;
        }
        .movie-card:hover { border-color: var(--primary); transform: translateY(-5px); }
        .poster-box { position: relative; aspect-ratio: 2/3; }
        .poster-box img { width: 100%; height: 100%; object-fit: cover; }
        .badge-score {
            position: absolute;
            top: 8px; right: 8px;
            background: rgba(0,0,0,0.8);
            color: #ffc107;
            padding: 3px 7px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        .info { padding: 12px; }
        .title {
            font-size: 0.85rem;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .meta { font-size: 0.75rem; color: var(--text-dim); margin-top: 5px; }

        /* PAGINATION */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 40px;
        }
        .btn-page {
            background: #222; border: 1px solid #444; color: white;
            width: 45px; height: 45px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-size: 1.2rem;
        }
        .btn-page:hover:not(:disabled) { background: var(--primary); border-color: var(--primary); }
        .btn-page:disabled { opacity: 0.2; cursor: not-allowed; }
        #page-num { font-weight: 800; color: var(--primary); font-size: 1.2rem; }
        
        /* FOOTER STYLES */
        footer {
            background-color: #000;
            border-top: 1px solid #222;
            padding: 40px 20px 20px;
            margin-top: 50px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            text-align: center;
        }

        @media (min-width: 768px) {
            .footer-content {
                grid-template-columns: 2fr 1fr 1fr;
                text-align: left;
            }
        }

        .footer-logo {
            color: var(--primary);
            font-weight: 800;
            font-size: 1.5rem;
            text-decoration: none;
            margin-bottom: 15px;
            display: block;
        }

        .footer-desc {
            color: var(--text-dim);
            font-size: 0.85rem;
            line-height: 1.6;
            max-width: 400px;
        }

        .footer-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #fff;
        }

        .footer-bottom {
            max-width: 1200px;
            margin: 40px auto 0;
            padding-top: 20px;
            border-top: 1px solid #1a1a1a;
            text-align: center;
            font-size: 0.75rem;
            color: #555;
        }

        .footer-links {
            list-style: none;
            padding: 0; /* Menghilangkan padding default browser agar sejajar lurus */
            margin: 0;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

.footer-links a {
    color: var(--text-dim);
    text-decoration: none;
    font-size: 0.9rem;
    transition: 0.3s;
    display: block; /* Membuat area klik lebih luas */
}

.footer-links a:hover {
    color: var(--primary);
    padding-left: 5px; /* Efek geser sedikit saat dihover */
}

/* Memperbaiki alignment di mobile */
@media (max-width: 767px) {
    .footer-content {
        text-align: center;
    }
    .footer-links li {
        text-align: center;
    }
}

.social-icons {
    display: flex;
    gap: 20px;
    justify-content: center;
    margin-top: 25px;
}

@media (min-width: 768px) {
    .social-icons { justify-content: flex-start; }
}

.social-icons a {
    display: inline-flex;
    transition: all 0.3s ease;
}

/* Warna hover masing-masing brand */
.social-icons a:hover .bi-facebook { color: #1877F2; filter: drop-shadow(0 0 5px #1877F2); }
.social-icons a:hover .bi-instagram { color: #E4405F; filter: drop-shadow(0 0 5px #E4405F); }
.social-icons a:hover .bi-twitter-x { color: #ffffff; filter: drop-shadow(0 0 5px #ffffff); }
.social-icons a:hover .bi-telegram { color: #24A1DE; filter: drop-shadow(0 0 5px #24A1DE); }
.social-icons a:hover .bi-whatsapp { color: #25D366; filter: drop-shadow(0 0 5px #25D366); }

.social-icons a:hover {
    transform: translateY(-5px);
}
    </style>
</head>
<body>

<div class="header-fixed">
    <nav class="navbar">
        <a href="index.html" class="logo">ID<span class="text-white">MOVIE</span></a>
        <div class="search-container">
            <form id="searchForm" onsubmit="event.preventDefault(); executeSearch();">
                <input type="text" id="searchInput" class="search-input" placeholder="Cari film favorit..." autocomplete="off">
                <i class="bi bi-search search-icon" onclick="executeSearch()" style="cursor:pointer"></i>
            </form>
        </div>
        <div class="share-group d-none d-md-flex align-items-center">
            <a href="kontak.html" class="btn-social text-white ms-3" title="Hubungi Kami"><i class="bi bi-person-circle" style="font-size: 1.4rem;"></i></a>
        </div>
    </nav>

<div class="filter-bar" id="filterBar">
    <div class="f-item active" onclick="setMode('trending', '', this)">üî• Trending</div>
    <div class="f-item" onclick="setMode('top_rated', '', this)">üèÜ Box Office</div>
    <div class="f-item" onclick="setMode('country', 'ID', this)">üáÆüá© Indonesia</div>

    <div class="f-item" onclick="setMode('genre', '28', this)">Action</div>
    <div class="f-item" onclick="setMode('genre', '12', this)">Adventure</div>
    <div class="f-item" onclick="setMode('genre', '16', this)">Animation</div>
    <div class="f-item" onclick="setMode('genre', '35', this)">Comedy</div>
    <div class="f-item" onclick="setMode('genre', '80', this)">Crime</div>
    <div class="f-item" onclick="setMode('genre', '99', this)">Documentary</div>
    <div class="f-item" onclick="setMode('genre', '18', this)">Drama</div>
    <div class="f-item" onclick="setMode('genre', '10751', this)">Family</div>
    <div class="f-item" onclick="setMode('genre', '14', this)">Fantasy</div>
    <div class="f-item" onclick="setMode('genre', '36', this)">History</div>
    <div class="f-item" onclick="setMode('genre', '27', this)">Horror</div>
    <div class="f-item" onclick="setMode('genre', '10402', this)">Music</div>
    <div class="f-item" onclick="setMode('genre', '9648', this)">Mystery</div>
    <div class="f-item" onclick="setMode('genre', '10749', this)">Romance</div>
    <div class="f-item" onclick="setMode('genre', '878', this)">Sci-Fi</div>
    <div class="f-item" onclick="setMode('genre', '10770', this)">TV Movie</div>
    <div class="f-item" onclick="setMode('genre', '53', this)">Thriller</div>
    <div class="f-item" onclick="setMode('genre', '10752', this)">War</div>
    <div class="f-item" onclick="setMode('genre', '37', this)">Western</div>
</div>
    </div>

    <div class="container">
        <div class="section-header">
            <h2 id="listTitle" class="section-title">Film Trending</h2>
        </div>
        
        <div id="movieGrid" class="movie-grid"></div>

        <div class="pagination">
            <button id="prevBtn" class="btn-page" onclick="changePage(-1)"><i class="bi bi-arrow-left-short"></i></button>
            <span id="page-num">1</span>
            <button id="nextBtn" class="btn-page" onclick="changePage(1)"><i class="bi bi-arrow-right-short"></i></button>
        </div>
    </div>

<footer>
        <div class="footer-content">
            <div>
                <a href="#" class="footer-logo">ID MOVIE</a>
                <p class="footer-desc">
                    Nikmati pengalaman streaming film terbaik secara gratis. Kami menyediakan informasi film terbaru, box office, hingga konten trending setiap harinya.
                </p>
<div class="social-icons">
    <a href="#" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(window.location.href), '_blank')">
        <i class="bi bi-facebook"></i>
    </a>

    <a href="#" onclick="window.open('https://api.whatsapp.com/send?text=Nonton film gratis di ID MOVIE: ' + encodeURIComponent(window.location.href), '_blank')">
        <i class="bi bi-whatsapp"></i>
    </a>

    <a href="#" onclick="window.open('https://twitter.com/intent/tweet?url=' + encodeURIComponent(window.location.href) + '&text=Nonton film terbaru di ID MOVIE!', '_blank')">
        <i class="bi bi-twitter-x"></i>
    </a>

    <a href="https://t.me/idmovie_official" target="_blank">
        <i class="bi bi-telegram"></i>
    </a>
</div>
</div>

            <div>
                <h3 class="footer-title">Navigasi</h3>
                <ul class="footer-links">
                    <li><a href="#">Beranda</a></li>
                    <li><a href="#" onclick="setMode('trending', '', null)">Trending</a></li>
                    <li><a href="#" onclick="setMode('top_rated', '', null)">Box Office</a></li>
                    <li><a href="#" onclick="setMode('country', 'ID', null)">Film Indonesia</a></li>
                </ul>
            </div>

            <div>
                <h3 class="footer-title">Bantuan</h3>
                <ul class="footer-links">
                    <li><a href="dmca.html">DMCA</a></li>
                    <li><a href="privacy.html">Privacy Policy</a></li>
                    <li><a href="service.html">Terms of Service</a></li>
                    <li><a href="kontak.html">Kontak Kami</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            &copy; 2026 ID MOVIE. Powered by IDMOV CORP. All Rights Reserved.
        </div>
    </footer>

    <script>
        const API_KEY = '0ac7d6475232e17859d8e46b5dc9a435';
        const grid = document.getElementById('movieGrid');
        const listTitle = document.getElementById('listTitle');
        
        let state = {
            page: 1,
            mode: 'trending',
            param: '',
            query: ''
        };

        async function fetchMovies() {
            grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; padding: 100px; color:#666;">Sedang memuat koleksi...</p>';
            
            let isAdult = state.mode === 'adult' ? 'true' : 'false';
            let url = `https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&language=id-ID&page=${state.page}&include_adult=${isAdult}`;

            if (state.mode === 'trending') {
                url = `https://api.themoviedb.org/3/trending/movie/day?api_key=${API_KEY}&page=${state.page}`;
                listTitle.innerText = "üî• Sedang Trending";
            } else if (state.mode === 'top_rated') {
                url = `https://api.themoviedb.org/3/movie/top_rated?api_key=${API_KEY}&language=id-ID&page=${state.page}`;
                listTitle.innerText = "üèÜ Film Box Office";
            } else if (state.mode === 'adult') {
                url += `&with_genres=10749&sort_by=popularity.desc`;
                listTitle.innerText = "üîû Konten Dewasa (18+)";
            } else if (state.mode === 'country') {
                url += `&with_origin_country=${state.param}&sort_by=popularity.desc`;
                listTitle.innerText = "üáÆüá© Film Indonesia";
            } else if (state.mode === 'genre') {
                url += `&with_genres=${state.param}&sort_by=popularity.desc`;
                listTitle.innerText = "Kategori: " + state.query;
            } else if (state.mode === 'search') {
                url = `https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&language=id-ID&query=${state.param}&page=${state.page}`;
                listTitle.innerText = "Hasil Pencarian";
            }

            try {
                const res = await fetch(url);
                const data = await res.json();
                render(data.results);
                document.getElementById('prevBtn').disabled = state.page === 1;
            } catch (e) { 
                grid.innerHTML = "<p style='grid-column:1/-1; text-align:center;'>Koneksi bermasalah. Coba lagi nanti.</p>"; 
            }
        }

function render(movies) {
    grid.innerHTML = "";
    if (!movies || movies.length === 0) {
        grid.innerHTML = "<p style='grid-column:1/-1; text-align:center; padding:50px;'>Film tidak ditemukan.</p>";
        return;
    }

    movies.forEach(m => {
        // URL TMDB yang sudah diperbaiki (/t/p/)
        const posterUrl = m.poster_path 
            ? `https://image.tmdb.org/t/p/w500${m.poster_path}` 
            : 'https://via.placeholder.com/500x750?text=No+Poster';
            
        const year = m.release_date ? m.release_date.split('-')[0] : 'N/A';
        
        const card = document.createElement('div');
        card.className = 'movie-card';
        card.onclick = () => window.location.href = `vp.html?id=${m.id}`;
        
        card.innerHTML = `
            <div class="poster-box">
                <img data-src="${posterUrl}" 
                     class="lazy-img" 
                     alt="${m.title}" 
                     onerror="this.src='https://via.placeholder.com/500x750?text=Error'">
                <div class="badge-score"><i class="bi bi-star-fill"></i> ${m.vote_average.toFixed(1)}</div>
            </div>
            <div class="info">
                <div class="title">${m.title}</div>
                <div class="meta">${year} ‚Ä¢ Film</div>
            </div>`;
        grid.appendChild(card);
    });

    // Jalankan fungsi pengamat gambar (lazy load)
    initLazyLoading();
}

// Fungsi Utama Lazy Loading
function initLazyLoading() {
    const images = document.querySelectorAll('.lazy-img');
    
    const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.src = img.dataset.src; // Pindahkan data-src ke src asli
                img.onload = () => img.classList.add('loaded'); // Munculkan dengan animasi
                observer.unobserve(img); // Berhenti mengamati jika sudah dimuat
            }
        });
    });

    images.forEach(img => imageObserver.observe(img));
}

        function setMode(mode, param, el) {
            document.querySelectorAll('.f-item').forEach(i => i.classList.remove('active'));
            if(el) el.classList.add('active');
            state.mode = mode;
            state.param = param;
            state.query = el ? el.innerText : '';
            state.page = 1;
            document.getElementById('page-num').innerText = 1;
            fetchMovies();
        }

        function changePage(step) {
            state.page += step;
            document.getElementById('page-num').innerText = state.page;
            fetchMovies();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        let timer;
        document.getElementById('searchInput').addEventListener('input', (e) => {
            clearTimeout(timer);
            const val = e.target.value;
            if (val.length < 3) {
                if(val.length === 0) setMode('trending', '', document.querySelector('.f-item'));
                return;
            }
            timer = setTimeout(() => {
                state.mode = 'search';
                state.param = val;
                state.page = 1;
                fetchMovies();
            }, 700);
        });

        fetchMovies();
        
// Fungsi eksekusi pencarian
function executeSearch() {
    const val = document.getElementById('searchInput').value;
    if (val.length >= 3) {
        state.mode = 'search';
        state.param = val;
        state.page = 1;
        fetchMovies();
    }
}

// Ganti bagian DOMContentLoaded lama Anda dengan ini
window.addEventListener('DOMContentLoaded', () => {
    const params = new URLSearchParams(window.location.search);
    const filter = params.get('filter');
    const query = params.get('q'); // Menangkap parameter 'q' dari URL

    if (query) {
        // Jika datang dari halaman lain dengan query pencarian
        document.getElementById('searchInput').value = query;
        state.mode = 'search';
        state.param = query;
        state.page = 1;
        fetchMovies();
    } else if (filter) {
        // Logika filter lama tetap jalan
        if (filter === 'trending') setMode('trending', '', document.querySelector('[onclick*="trending"]'));
        else if (filter === 'top_rated') setMode('top_rated', '', document.querySelector('[onclick*="top_rated"]'));
        else if (filter === 'country') setMode('country', 'ID', document.querySelector('[onclick*="country"]'));
    } else {
        fetchMovies(); // Load default trending jika tidak ada parameter
    }
});

// Update event listener searchInput agar lebih responsif
document.getElementById('searchInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        executeSearch();
    }
});

// Fungsi untuk menangkap parameter pencarian di URL
function checkSearchQuery() {
    const urlParams = new URLSearchParams(window.location.search);
    const query = urlParams.get('q');

    if (query) {
        // Jika ada query, jalankan fungsi cari film (sesuaikan dengan fungsi TMDB Anda)
        console.log("Mencari film: " + query);
        searchMovies(query); // Pastikan Anda punya fungsi searchMovies
        
        // Opsional: Ubah judul "Rekomendasi" menjadi "Hasil Pencarian: ..."
        const gridTitle = document.querySelector('h5.fw-bold');
        if(gridTitle) gridTitle.innerHTML = `<i class="bi bi-search me-2"></i> HASIL PENCARIAN: ${query.toUpperCase()}`;
    }
}

// Panggil fungsi ini saat halaman dimuat
window.onload = () => {
    init(); // Fungsi init lama Anda
    checkSearchQuery();
};

    </script>
</body>
</html>
